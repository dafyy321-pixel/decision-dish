# 🍱《等会吃啥》——PRD 产品需求文档

## 一、产品概述

**产品定位：**
一款为大学生解决“吃饭选择困难症”的轻量化小应用。通过系统预设店铺池或用户自定义名单，随机抽取出吃饭选项，以轻松有趣的方式帮助学生决定“今天吃啥”。

**产品目标：**

* 减少选择困难带来的时间浪费
* 让吃饭决策变得轻松、有趣
* 鼓励校园社交分享（如“你抽到了啥？”）

---

## 二、产品核心功能

> 注：以下功能清单与说明已根据当前开发进度同步更新。

### 2.1 功能清单概览

| 优先级 | 功能模块 | 功能描述 | 实现状态 | 实现组件/文件 |
| --- | --- | --- | --- | --- |
| P0 | 模式切换 | 系统推荐/自定义模式切换 | ✅ 已实现 | `ModeSelector.tsx` |
| P0 | 系统推荐 | 从云端 Supabase 或 20 家预设餐厅随机抽取（自动回退） | ✅ 已实现 | `useRestaurants.ts` + `restaurants.ts` |
| P0 | 自定义列表 | 添加/删除/管理自定义餐厅（最多20个，支持从收藏添加） | ✅ 已实现 | `CustomListManager.tsx` |
| P0 | 转盘动画 | 1.5s 旋转动画 + 渐隐效果 | ✅ 已实现 | `SpinWheel.tsx` |
| P0 | 结果展示 | 展示餐厅名称/地址/分类（含收藏按钮） | ✅ 已实现 | `ResultDisplay.tsx` |
| P0 | 再抽一次 | 重置结果，重新抽取 | ✅ 已实现 | `ResultDisplay.tsx` |
| P0 | 本地存储 | localStorage 持久化自定义/历史/统计数据 | ✅ 已实现 | `Index.tsx` 等 |
| P0 | Toast 提示 | 操作反馈（成功/错误提示） | ✅ 已实现 | Sonner 组件 |
| P1 | 历史记录存储 | 自动记录最近100次抽取 | ✅ 已实现 | `Index.tsx`（`draw_history`）|
| P1 | 历史记录 UI | 展示/删除/清空历史记录，支持收藏 | ✅ 已实现 | `History.tsx` |
| P1 | 个人中心 | 使用统计（总次数/收藏数/历史数/最近抽取/Top5） | ✅ 已实现 | `Profile.tsx` |
| P1 | 数据导入导出 | JSON 格式导入导出自定义列表 | ⏸️ 待开发 | - |
| P2 | 分享海报生成 | 生成图片分享到社交媒体 | ⏸️ 待开发 | - |
| P2 | 收藏列表页 | 查看/删除/清空收藏 | ✅ 已实现 | `Favorites.tsx` |

#### 新增已实现功能（v1.0 MVP 阶段）

| 优先级 | 功能模块 | 功能描述 | 实现状态 | 实现组件/文件 |
| --- | --- | --- | --- | --- |
| P0+ | 底部导航栏 | 分享/收藏/抽奖/历史/我的 (5个页面快捷入口) | ✅ 已实现 | `BottomNavBar.tsx` |
| P0+ | 分享页面 | 微信/QQ唤起 + 复制链接 + 二维码生成 | ✅ 已实现 | `Share.tsx` + `qrcode.react` |
| P0+ | 反馈卡片 | “必看！！”可展开卡片，包含问卷与微信群二维码 | ✅ 已实现 | `FeedbackCard.tsx` |
| P0+ | Supabase 集成 | 云端餐厅数据 + 自动回退本地 | ✅ 已实现 | `supabase.ts` + `useRestaurants.ts` |

### 2.2 功能详细规格


#### 2️⃣ 系统推荐模式

**功能描述**
- 从 20 家预设餐厅中随机抽取
- 展示：餐厅名称 + 地址 + 分类标签
- 支持“再抽一次”功能

**数据结构**
```typescript
interface Restaurant {
  id: string;           // 唯一标识
  name: string;         // 餐厅名称
  address: string;      // 地址信息
  category: string;     // 餐厅分类
}
```

**预设数据**
- 存储位置：`src/data/restaurants.ts`
- 餐厅数量：20 家
- 分类：中餐、麻辣烫、米线、烧烤、快餐、日料、韩餐、火锅等

**交互逻辑**
```
1. 选择“系统推荐”模式
2. 显示“从 20 家精选店铺中随机抽取”提示
3. 点击“开始抽取”按钮
4. 播放转盘动画 (1.3s)
5. 展示抽取结果
6. 可点击“再抽一次”重新抽取
```

#### 3️⃣ 用户自定义模式

**功能描述**
- 用户可自由添加、管理餐厅名单
- 支持添加、删除操作
- 数据自动保存至 localStorage
- 最多支持 20 个自定义项

**限制规则**
- 最小数量：0 个（为空时禁用抽取按钮）
- 最大数量：20 个
- 名称长度：1-50 字符
- 不允许重复名称

**数据存储**
- Storage Key: `custom-restaurants`
- 格式：`Restaurant[]`（兼容旧版 `string[]`，首次加载会自动转换）
- 示例：`[{ id: "custom-1730712345", name: "麦当劳", address: "", category: "自定义" }]`

**操作反馈**
| 操作 | Toast 提示 |
| --- | --- |
| 添加成功 | “添加成功” |
| 删除成功 | “删除成功” |
| 名称为空 | “请输入店铺名称” |
| 名称重复 | “该店铺已存在” |
| 超过限制 | “最多添加 20 个店铺” |
| 列表为空时抽取 | “请先添加自定义店铺” |

**交互逻辑**
```
1. 切换至“自定义模式”
2. 显示自定义列表管理面板
3. 输入餐厅名称
4. 点击“+”或回车键添加
5. 验证通过后添加到列表
6. 显示 Toast 提示
7. 自动保存至 localStorage
8. 点击删除按钮可删除项目
```

#### 4️⃣ 抽取动画 (Spin Wheel)

**功能描述**
- 12 个扇形组成的圆形转盘
- 渐变色谱：草绿色到暖橙色
- 中心 Logo 图标
- 顶部箭头指示器
- 装饰星星动画

**动画参数**
- 旋转速度：0.5s/圈（快速旋转）
- 用户可见时长：1.3s
- 内部旋转定时器：1.5s（用于停转与状态切换）
- 模糊效果：`blur-sm` (旋转时)
- 结束动画：中心 Logo 弹跳动效

**视觉效果**
- 背景：半透明高斯模糊 `bg-background/95 backdrop-blur-sm`
- 阴影：`shadow-2xl`
- 边框：8px 白色边框
- 光晕：`shadow-[0_0_60px_rgba(162,210,154,0.4)]`

**交互逻辑**
```
1. 点击抽取按钮
2. 立即计算随机结果
3. 全屏显示转盘动画
4. 转盘快速旋转 1.5s
5. 停止旋转，移除模糊
6. 中心 Logo 弹跳
7. 1.3s 后关闭转盘
8. 显示结果页面
```

#### 5️⃣ 结果展示

**展示内容**
- 提示文字：“今天吃这个！”
- 餐厅名称：大字体显示
- 系统模式：显示地址 + 分类标签
- 自定义模式：仅显示名称

**视觉效果**
- 背景渐变：`from-primary/10 via-secondary/10 to-accent/10`
- 边框：2px `border-primary/20`
- 圆角：`rounded-3xl`
- 出场动画：`animate-bounce-in`（弹跳放大）

**按钮交互**
- 按钮文字：“再抽一次”
- 图标：`RefreshCw`
- Hover 效果：背景变深 + 边框变亮
- 点击后：重置结果，返回初始状态

#### 6️⃣ 模式切换

**功能描述**
- 双按钮切换式设计
- 选项：“系统推荐” / “自定义”
- 默认选中：系统推荐

**视觉设计**
- 容器：卡片背景 `bg-card rounded-3xl`
- 选中态：`bg-primary` + `shadow-md`
- 未选中：`ghost` 样式 + `text-muted-foreground`
- 图标：`Utensils`（系统）/ `ListPlus`（自定义）

**交互规则**
- 切换模式时，自动重置抽取状态
- 已有结果时，隐藏模式切换器
- 切换动画：平滑过渡 `transition-all`

---



---

## 三、技术栈与架构

### 3.1 技术选型

| 模块    | 技术方案                 | 版本 | 理由        |
| ----- | -------------------- | --- | --------- |
| 前端框架  | **React + Vite**     | 18.3.1 / 5.4.19 | 轻量、开发体验优秀、HMR 快速 |
| 类型系统  | **TypeScript**       | 5.8.3 | 类型安全、提升代码质量 |
| UI 框架 | **Tailwind CSS + shadcn/ui**     | 3.4.17 | 快速实现清爽风格,组件库丰富、可定制性强  |
| UI 组件库 | **Radix UI**        | - | 无障碍设计、无头组件、高度可定制 |
| 图标库   | **Lucide React**     | 0.462.0 | 现代化图标、Tree-shaking 友好 |
| 动画库   | **Tailwind CSS Animations**    | 1.0.7 | 使用 Tailwind 自定义动画实现轮盘、卡片动效 |
| 路由管理  | **React Router DOM** | 6.30.1 | SPA 路由、404 处理 |
| 状态管理  | **React Hooks + localStorage** | - | 轻量简单、满足 MVP 需求 |
| 数据请求  | **TanStack Query**   | 5.83.0 | 强大的缓存和状态管理（为后续扩展预留） |
| 表单管理  | **React Hook Form**  | 7.61.1 | 性能优异、验证便捷 |
| Toast 通知 | **Sonner**          | 1.7.4 | 简洁美观的提示组件 |
| 代码检查  | **ESLint**          | 9.32.0 | 代码质量保证 |
| 部署    | **Vercel / Netlify** | - | 快速上线、免服务器、自动化 CI/CD |

### 3.2 架构设计

```
┌─────────────────────────────────────────┐
│         用户界面层 (UI Layer)            │
│  ┌──────────┐  ┌──────────┐  ┌────────┐ │
│  │主应用页面 │  │404页面  │ │
│  └──────────┘  └──────────┘  └────────┘ │
└─────────────────────────────────────────┘
              ↓
┌─────────────────────────────────────────┐
├────── 组件层 (Component Layer)          │
│  ┌────────────┐  ┌───────────────┐      │
│  │模式选择器   │  │自定义列表管理  │      │
│  ├────────────┤  ├───────────────┤      │
│  │抽取按钮     │  │结果展示组件    │      │
│  ├────────────┤  ├───────────────┤      │
│  │转盘动画     │  │反馈卡+导航栏    │      │
│  ├────────────┤  │UI基础组件库    │      │
│  └────────────┘  └───────────────┘      │
└─────────────────────────────────────────┐
              ↓
┌─────────────────────────────────────────┐
│        数据层 (Data Layer)               │
│  ┌──────────────────────┬──────────────────┬────────────────┐  │
│  │云端餐厅数据           │系统预设餐厅数据   │用户自定义数据  │  │
│  │(Supabase: restaurants)│(restaurants.ts) │(localStorage) │  │
│  │                      │  +自动回退机制    │  +历史记录    │  │
│  └──────────────────────┴──────────────────┴────────────────┘  │
└─────────────────────────────────────────┘
```

---

### 3.3 数据来源与回退策略

**数据来源**：
- ✅（已配置环境变量时）优先从 Supabase `public.restaurants` 表获取 `is_active=true` 的餐厅列表，按名称排序
- ✅ 若请求失败或返回空数据，自动回退到本地 `src/data/restaurants.ts` 预设列表（20家）
- ⚠️ 注意：当前实现中 `src/lib/supabase.ts` 在环境变量缺失时会抛错，需先配置 `.env`（参见 `SUPABASE_SETUP.md`）或调整为静默降级方案
- ✅ 实现位置：`src/hooks/useRestaurants.ts`（TanStack Query 缓存）
- ✅ 类型定义：`src/types/database.types.ts`

**localStorage 存储**：
- ✅ 自定义餐厅列表 (key: `custom-restaurants`)
- ✅ 抽取历史记录 (key: `draw_history`，最多100条)
- ✅ 统计数据 (keys: `total_draws`, `last_draw_time`)

## 四、UI 风格与视觉效果（参考你提供的图）

### 🎨 整体风格

* 清新、柔和、治愈风格
* 使用柔和的绿色、米白、浅灰为主色
* 圆角大、留白多、布局轻盈
* 视觉语言亲切、情绪平和
* 使用插画风格元素（比如可爱的食物角色、转盘动画）

### 🌈 颜色方案

| 类型   | 颜色            | 用途     |
| ---- | ------------- | ------ |
| 主色   | `#A2D29A`（草绿） | 按钮、图标  |
| 辅色   | `#F6F6EE`（米白） | 背景     |
| 强调色  | `#F7B267`（暖橙） | 抽奖结果高亮 |
| 文本主色 | `#2C2C2C`     | 主体文字   |
| 文本次色 | `#8E8E8E`     | 辅助说明文字 |

### 🖋️ 字体选择

* **系统字体**：-apple-system, BlinkMacSystemFont, "Segoe UI", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", sans-serif
* 字重建议：标题 600，正文 400

### 📱 视觉动效

* 轻微弹跳的“抽取”按钮动效
* 抽奖过程有旋转/闪烁/摇摆效果
* 结果页出现时有淡入放大动画

---

## 五、信息架构 & 页面流程

### 5.1 信息架构 (IA)

```
应用入口
  │
  └── 主应用页面 (Index)
       ├── 头部：Logo + Slogan
       ├── 模式选择器
       │    ├── 系统推荐模式
       │    │    ├── 提示信息：20家精选
       │    │    └── 抽取按钮
       │    │
       │    └── 自定义模式
       │         ├── 自定义列表管理
       │         │    ├── 输入框 + 添加按钮
       │         │    ├── 列表展示（滚动）
       │         │    └── 删除按钮
       │         └── 抽取按钮
       │
       ├── 转盘动画层 (全屏遮罩)
       │    ├── 提示文字
       │    ├── 转盘动画
       │    └── 装饰元素
       │
       ├── 结果展示
       │    ├── 结果卡片
       │    │    ├── 提示文字
       │    │    ├── 餐厅名称
       │    │    ├── 地址信息（系统模式）
       │    │    └── 分类标签（系统模式）
       │    └── 再抽一次按钮
       │
       └── 底部：“吃饭愉快🍱”
```

### 5.2 用户流程图

#### 流程 A：系统推荐模式

```
[启动应用]
    ↓
[进入主页面]
    ↓
[默认选中“系统推荐”]
    ↓
[显示“从 20 家精选店铺中随机抽取”]
    ↓
[点击“开始抽取”按钮]
    ↓
[计算随机结果] → [转盘动画 1.3s]
    ↓
[展示结果卡片]
    ├── [点击“再抽一次”] → 返回“点击开始抽取”
    └── [切换模式] → 返回“选择模式”
```

#### 流程 B：自定义模式

```
[进入主页面]
    ↓
[点击“自定义”模式]
    ↓
[显示自定义列表管理面板]
    │
    ├── [列表为空] → [显示空状态提示] + [禁用抽取按钮]
    │
    └── [有数据] → [显示列表]
         ↓
    [输入餐厅名称]
         ↓
    [点击添加/回车键]
         │
         ├── [验证失败] → [Toast 错误提示]
         │
         └── [验证成功]
              ↓
         [添加到列表]
              ↓
         [保存到 localStorage]
              ↓
         [Toast 成功提示]
              ↓
    [点击“开始抽取”]
         ↓
    [转盘动画] → [展示结果]
```

### 5.3 关键页面详细设计

| 页面      | 路由 | 功能说明       | 主要元素                 | 响应式设计 |
| ------- | --- | ---------- | -------------------- | --- |
| 🏠 主页面  | `/` | 核心功能页 | Logo + 模式切换 + 抽取区 + 结果区 | 最大宽度 448px，居中 |
| 🔗 分享页 | `/share` | 分享到微信/QQ、复制链接、二维码 | 按钮组 + 链接展示 + 二维码 | 居中显示 |
| ❤️ 收藏页 | `/favorites` | 查看/删除/清空收藏 | 列表 + 操作按钮 | 居中显示 |
| 🕒 历史页 | `/history` | 展示/删除/清空历史记录，支持收藏 | 列表 + 操作按钮 + 对话框 | 居中显示 |
| 👤 我的页 | `/profile` | 使用统计与最常选择 | 统计卡片 + Top5 条形图 | 居中显示 |
| 🚫 404页 | `*` | 错误页面 | 错误提示 + 返回按钮 | 居中显示 |

#### 页面尺寸规范

| 设备类型 | 视口宽度 | 内容宽度 | padding | 优化重点 |
| --- | --- | --- | --- | --- |
| 手机 | 375px - 767px | 100% - 48px | 24px | 主要优化 |
| 平板 | 768px - 1023px | 448px | - | 居中显示 |
| 桌面 | 1024px+ | 448px | - | 居中显示 |

---

## 六、数据埋点与分析

### 6.1 核心指标 (Core Metrics)

| 指标类型 | 指标名称 | 计算方式 | 目标值 | 优先级 |
| --- | --- | --- | --- | --- |
| 用户参与 | 日活跃用户 (DAU) | 每日打开应用的独立用户数 | - | P0 |
| 用户参与 | 平均每日抽取次数 | 总抽取次数 / DAU | 3-5 次 | P0 |
| 用户留存 | 次日留存率 | Day 1 留存用户 / 新增用户 | >40% | P1 |
| 功能使用 | 自定义模式使用率 | 自定义模式抽取 / 总抽取 | >30% | P1 |
| 功能使用 | 平均自定义列表长度 | 总自定义项数 / 自定义用户数 | 5-10 个 | P1 |
| 体验指标 | 页面加载时间 | 从请求到首屏渲染完成 | <1s | P0 |
| 体验指标 | 抽取动画流畅度 | FPS | ≥60 | P0 |

### 6.2 埋点事件设计

#### 基础事件

| 事件名称 | 触发时机 | 事件参数 | 业务目的 |
| --- | --- | --- | --- |
| `app_launch` | 应用启动 | `timestamp`, `device_type` | 统计启动次数、设备分布 |
| `page_view` | 主页面加载完成 | `load_time` | 监控页面性能 |

#### 功能事件

| 事件名称 | 触发时机 | 事件参数 | 业务目的 |
| --- | --- | --- | --- |
| `mode_selected` | 用户切换模式 | `mode: "system" \| "custom"` | 分析模式偏好 |
| `draw_clicked` | 点击抽取按钮 | `mode`, `timestamp` | 统计使用频率 |
| `draw_result` | 抽取结果展示 | `mode`, `result_name`, `result_category` | 分析热门餐厅 |
| `draw_again` | 点击再抽一次 | `mode`, `previous_result` | 统计重抽率 |

#### 自定义模式事件

| 事件名称 | 触发时机 | 事件参数 | 业务目的 |
| --- | --- | --- | --- |
| `custom_item_added` | 成功添加自定义项 | `item_name`, `total_count` | 分析添加行为 |
| `custom_item_deleted` | 删除自定义项 | `total_count` | 分析删除行为 |
| `custom_list_loaded` | 加载本地数据 | `items_count` | 统计自定义用户数 |

#### 错误事件

| 事件名称 | 触发时机 | 事件参数 | 业务目的 |
| --- | --- | --- | --- |
| `validation_error` | 输入验证失败 | `error_type`, `error_message` | 优化验证逻辑 |
| `storage_error` | localStorage 操作失败 | `operation`, `error_message` | 监控存储问题 |

### 6.3 数据分析仪表板

#### 核心指标仪表板

```
╔══════════════════════════════════════╗
║         等会吃啥 - 数据仪表板          ║
╠══════════════════════════════════════╣
║ 基础数据                             ║
║ - 日活跃用户 (DAU)                   ║
║ - 总抽取次数                         ║
║ - 平均每用户抽取次数               ║
╠──────────────────────────────────────╣
║ 模式使用分布                       ║
║ [饼图] 系统推荐 vs 自定义           ║
╠──────────────────────────────────────╣
║ 热门餐厅 Top 10                     ║
║ [条形图] 餐厅名称 | 抽取次数       ║
╠──────────────────────────────────────╣
║ 自定义数据分析                     ║
║ - 自定义用户数                     ║
║ - 平均列表长度                     ║
║ - 每天新增/删除项数               ║
╠──────────────────────────────────────╣
║ 用户行为趋势                       ║
║ [折线图] 每日抽取次数趋势         ║
╚══════════════════════════════════════╝
```

### 6.4 实施计划

**阶段 1：MVP 阶段（当前）**
- 仅在 console 输出关键事件
- 本地存储基本统计数据

**阶段 2：数据采集（v1.1）**
- 接入 Google Analytics 4
- 配置所有核心事件
- 设置自定义维度

**阶段 3：深度分析（v1.2）**
- 考虑接入 Mixpanel 或 Amplitude
- 构建实时数据仪表板
- A/B 测试能力

> **隐私声明**：所有数据采集均为匿名化，不收集个人敏感信息，仅用于产品优化。

---

## 七、版本规划与里程碑

### v1.0 MVP（已完成）
- 基础框架（React + Vite + TS + Tailwind + shadcn/ui）
- 系统推荐逻辑（本地预设数据随机）
- 自定义列表（新增/删除/校验/本地存储）
- 转盘动画（全屏遮罩 + 旋转 + 中心 Logo 动效）
- 结果展示（地址/分类标签）
- Toast 提示反馈
- 响应式适配（以移动端为主）

### v1.1（当前）
- ✅ 历史记录存储（最近 100 条）
- ✅ 历史记录 UI 页面（列表/删除/清空/收藏）
- ✅ 收藏功能（结果页收藏 + 收藏列表页）
- ✅ 分享页（微信/QQ唤起、复制链接、二维码）
- ✅ 个人中心（统计面板）
- ❌ 数据导入/导出（JSON）
- ❌ 埋点：接入 GA4，完成核心事件上报

### v1.2（两周）
- 邀请分享：生成分享海报（结果截图 + 文案）
- 数据导入/导出（JSON 文件 + 粘贴文本）
- 埋点：GA4 事件接入与仪表盘联动
- 适配：桌面端细节优化（快捷键触发抽取）

### v1.3（探索）
- 多人投票：多人各自提交选项，系统统一随机
- 权重抽取：支持为项设置权重（更常吃的概率更高）
- 分类筛选：系统模式支持按分类抽取

> 每个版本均需经过：需求冻结 → 开发 → 自测 → 预发 → 上线 → 统计分析 → 迭代优化

---

## 八、设计规范

### 8.1 视觉设计系统

| 项目        | 规范 | 实现方案 |
| --------- | --- | --- |
| **设计语言**  | 清新、柔和、治愈风 | 大圆角、留白多、轻微阴影 |
| **主色调**   | 草绿系 (#A2D29A) | `hsl(110 38% 71%)` |
| **辅助色**   | 淡绿色 + 暖橙色 | secondary: `hsl(110 45% 85%)`, accent: `hsl(30 88% 69%)` |
| **字体系统**    | 系统字体栈 | -apple-system, PingFang SC, Microsoft YaHei |
| **字体大小**    | 基准 16px | 标题 24-36px，正文 14-16px |
| **字重**    | 标题 600，正文 400 | font-semibold, font-normal |
| **圆角** | 12-24px 多级圆角系统 | sm:12px, md:16px, lg:24px, 3xl:24px |
| **阴影**  | 3 级阴影系统 | sm, md, xl, 2xl |
| **动画**   | 轻微弹跳、过渡平滑 | bounce-in, shake, float |
| **响应式**   | 移动优先 | 最大宽度 448px，居中显示 |
| **图标风格**  | Lucide 线性图标 | 20-24px |

### 8.2 组件规范

#### 按钮 (Button)

| 类型 | 高度 | 圆角 | 字重 | 使用场景 |
| --- | --- | --- | --- | --- |
| 主按钮 (primary) | 56px (h-14) | 24px (rounded-3xl) | 600 | 开始抽取 |
| 次要按钮 (outline) | 56px (h-14) | 24px (rounded-3xl) | 600 | 再抽一次 |
| 模式切换 | 48px (h-12) | 24px (rounded-3xl) | 500 | 系统/自定义 |
| 图标按钮 | 48px (h-12 w-12) | 16px (rounded-2xl) | - | 添加、删除 |

#### 输入框 (Input)

| 属性 | 值 | 说明 |
| --- | --- | --- |
| 高度 | 48px (h-12) | 与按钮对齐 |
| 圆角 | 16px (rounded-2xl) | - |
| 边框 | 2px | focus 时加粗 |
| 占位符 | 灰色 | muted-foreground |

#### 卡片 (Card)

| 属性 | 值 | 使用场景 |
| --- | --- | --- |
| 背景 | bg-card | 模式切换、自定义面板 |
| 圆角 | 24px (rounded-3xl) | 所有卡片 |
| 内边距 | 24px (p-6) | 标准内边距 |
| 阴影 | shadow-md | 默认阴影 |
| 边框 | 1px border | 可选 |

### 8.3 动画时序

| 动画名称 | 时长 | 缓动函数 | 使用场景 |
| --- | --- | --- | --- |
| bounce-in | 600ms | cubic-bezier(0.68, -0.55, 0.265, 1.55) | 结果卡片出场 |
| shake | 500ms | ease-in-out | 抽取按钮点击 |
| spin | 500ms | linear | 转盘旋转 |
| fade | 200ms | ease-out | 卡片淡入/过渡 |
| transition | 300ms | ease | 模式切换 |

### 8.4 布局规则

```
全局布局：
┌───────────────────────────────────┐
│  最外层 padding: 24px (px-6 py-8)      │
│  ┌─────────────────────────────┐  │
│  │  内容区：max-width: 448px   │  │
│  │  垂直间距：24px (space-y-6) │  │
│  │                            │  │
│  │  [Logo]                     │  │
│  │  ↓ 24px                    │  │
│  │  [模式切换]                │  │
│  │  ↓ 24px                    │  │
│  │  [功能区域]                │  │
│  │  ↓ 24px                    │  │
│  │  [底部信息]                │  │
│  └─────────────────────────────┘  │
└───────────────────────────────────┘
```

### 8.5 色彩使用指南

| 色彩类型 | HSL 值 | Hex | 使用场景 |
| --- | --- | --- | --- |
| background | 60 33% 95% | #F6F6EE | 页面背景 |
| foreground | 0 0% 17% | #2C2C2C | 主要文字 |
| primary | 110 38% 71% | #A2D29A | 主按钮、强调 |
| secondary | 110 45% 85% | - | 辅助背景 |
| accent | 30 88% 69% | #F7B267 | 结果高亮、标签 |
| muted | 60 20% 92% | - | 淡化背景 |
| muted-foreground | 0 0% 56% | #8E8E8E | 次要文字 |
| border | 110 25% 85% | - | 边框线 |
| card | 0 0% 100% | #FFFFFF | 卡片背景 |

### 8.6 可访问性 (Accessibility)

- 所有交互元素最小点击区域：44x44px
- 文字对比度：至少 WCAG AA 级（4.5:1）
- 所有图标按钮必须有 aria-label
- 支持键盘操作：Enter 键触发添加
- Toast 通知自动消失时间：3-5s

---

## 九、非功能性需求

### 9.1 性能指标

| 指标 | 目标值 | 优先级 | 测量方法 |
| --- | --- | --- | --- |
| 首屏加载时间 (FCP) | <1s | P0 | Lighthouse |
| 可交互时间 (TTI) | <1.5s | P0 | Lighthouse |
| 动画帧率 (FPS) | ≥60fps | P0 | Chrome DevTools |
| 包体积 (Bundle Size) | <500KB (gzip) | P1 | Webpack Bundle Analyzer |
| localStorage 读写 | <10ms | P1 | Performance API |

### 9.2 兼容性

| 项目 | 要求 | 备注 |
| --- | --- | --- |
| 浏览器 | Chrome 90+, Safari 14+, Firefox 88+, Edge 90+ | 主流现代浏览器 |
| 移动设备 | iOS 14+, Android 8+ | 主流移动系统 |
| 屏幕尺寸 | 320px - 1920px | 以 375px-768px 为主优化 |
| 网络环境 | 2G/3G/4G/WiFi | 离线可用（本地数据） |

### 9.3 安全性

| 项目 | 措施 | 优先级 |
| --- | --- | --- |
| XSS 防护 | React 自动转义、输入校验 | P0 |
| HTTPS | 强制 HTTPS 访问 | P0 |
| CSP | Content-Security-Policy 头 | P1 |
| 数据验证 | 前端输入长度/格式限制 | P0 |
| localStorage | 仅存储非敏感数据 | P0 |

### 9.4 可用性

| 指标 | 目标 | 备注 |
| --- | --- | --- |
| 服务可用性 | 99.9% | Vercel/Netlify SLA |
| 错误率 | <0.1% | 监控关键操作 |
| 降级策略 | localStorage 失败提示 | 用户友好 |

### 9.5 可维护性

- **代码规范**：ESLint + Prettier
- **类型检查**：TypeScript strict 模式
- **组件化**：单一职责原则，组件复用
- **文档**：README + JSDoc 注释
- **版本管理**：Git + Semantic Versioning

### 9.6 SEO & 分享优化

| 项目 | 实现方案 | 优先级 |
| --- | --- | --- |
| TDK | title, description, keywords | P0 |
| OG Tags | Open Graph 协议 | P1 |
| Favicon | 多尺寸 favicon | P0 |
| Apple Touch Icon | iOS 桌面图标 | P1 |
| PWA 支持 | manifest.json | P2 |

---

## 十、风险与对策

### 10.1 技术风险

| 风险 | 影响 | 概率 | 对策 |
| --- | --- | --- | --- |
| localStorage 存储失败 | 自定义数据丢失 | 低 | try-catch + Toast 提示用户导出数据 |
| 浏览器兼容性 | 部分用户无法使用 | 低 | Polyfill + 浏览器检测提示 |
| 动画性能问题 | 低端设备卡顿 | 中 | 检测设备性能，降级动画 |

### 10.2 产品风险

| 风险 | 影响 | 概率 | 对策 |
| --- | --- | --- | --- |
| 用户留存低 | 活跃用户少 | 中 | 快速迭代，增加互动性功能 |
| 功能单一 | 用户新鲜感下降 | 中 | 按版本计划增加新功能 |
| 预设数据过时 | 用户体验下降 | 低 | 定期更新餐厅数据 |

### 10.3 运营风险

| 风险 | 影响 | 概率 | 对策 |
| --- | --- | --- | --- |
| 用户增长缓慢 | 产品价值不被认可 | 中 | 社交分享、校园推广 |
| 竞品出现 | 市场份额被抢占 | 低 | 快速迭代，打造差异化 |

### 10.4 应急预案

**场景 1：localStorage 存储失败**
```
1. 在操作前进行可用性检测
2. 失败时 Toast 提示：“存储失败，请检查浏览器设置”
3. 仅在当前会话保留数据
4. 提供导出功能，手动保存
```

**场景 2：动画卡顿**
```
1. 检测 FPS < 30
2. 自动关闭转盘动画
3. 使用简单淡入效果替代
4. Toast 提示：“已为您优化动画效果”
```

---

## 十一、参考与灵感

### 11.1 竞品分析

| 产品名称 | 优点 | 缺点 | 借鉴点 |
| --- | --- | --- | --- |
| “今天吃什么”小程序 | 简单直接 | 设计过于简陋 | 核心功能逻辑 |
| “随机选择器” | 功能丰富 | 交互复杂 | 自定义功能 |
| Tinder | 滑动交互好 | 与场景不合 | 不适用 |

### 11.2 设计参考

* **Forest** — 清新柔和的视觉风格、治愈系色彩
* **小睡眠** — 插画与色彩氛围、情绪价值
* **Keep** — 轻量数据卡片设计、简洁布局
* **Duolingo** — 游戏化设计、动画反馈

### 11.3 技术资源

- [Vite 官方文档](https://vitejs.dev/)
- [React 官方文档](https://react.dev/)
- [shadcn/ui](https://ui.shadcn.com/)
- [Tailwind CSS](https://tailwindcss.com/)
- [Radix UI](https://www.radix-ui.com/)

---

## 十二、附录

### 附录 A：产品术语表

| 术语 | 英文 | 定义 |
| --- | --- | --- |
| MVP | Minimum Viable Product | 最小可行产品 |
| DAU | Daily Active Users | 日活跃用户 |
| FCP | First Contentful Paint | 首次内容绘制 |
| TTI | Time to Interactive | 可交互时间 |
| FPS | Frames Per Second | 每秒帧数 |
| localStorage | - | 浏览器本地存储 |
| Toast | - | 轻量级提示通知 |
| SPA | Single Page Application | 单页应用 |
| SEO | Search Engine Optimization | 搜索引擎优化 |

### 附录 B：文件结构说明

```
decision-dish/
├── public/                    # 静态资源（站点图标/清单/SEO）
│   ├── favicon.ico            # 站点图标
│   ├── favicon-16x16.png
│   ├── favicon-32x32.png
│   ├── android-chrome-*.png
│   ├── apple-touch-icon.png
│   ├── site.webmanifest
│   └── robots.txt
├── src/
│   ├── assets/               # 图片资源
│   │   ├── title-logo.png    # 标题 Logo
│   ├── components/           # React 组件
│   │   ├── ui/               # shadcn/ui 基础组件
│   │   ├── ModeSelector.tsx       # 模式选择器
│   │   ├── CustomListManager.tsx  # 自定义列表管理（支持从收藏添加）
│   │   ├── DrawButton.tsx         # 抽取按钮
│   │   ├── ResultDisplay.tsx      # 结果展示（含收藏）
│   │   ├── SpinWheel.tsx          # 转盘动画
│   │   ├── FeedbackCard.tsx       # 反馈信息卡（问卷 + 微信群）
│   │   └── BottomNavBar.tsx       # 底部导航栏
│   ├── data/                 # 数据配置
│   │   └── restaurants.ts    # 本地餐厅数据 (20 条)
│   ├── hooks/                # 数据 hooks
│   │   ├── useRestaurants.ts      # Supabase 数据获取（含分类）
│   │   └── useFavorites.ts        # 收藏云端同步（预留）
│   ├── lib/                  # 工具库
│   │   └── supabase.ts            # Supabase 客户端（需 .env）
│   ├── pages/                # 页面组件
│   │   ├── Index.tsx        # 主页（抽取 + 本地存储）
│   │   ├── Share.tsx        # 分享页（微信/QQ/复制链接/二维码）
│   │   ├── Favorites.tsx    # 收藏页（列表/删除/清空）
│   │   ├── History.tsx      # 历史页（列表/删除/清空/收藏）
│   │   ├── Profile.tsx      # 我的（统计面板/Top5）
│   │   └── NotFound.tsx     # 404 页面
│   ├── types/               # 类型定义
│   │   └── database.types.ts     # Supabase 类型
│   ├── App.tsx              # 应用根组件（路由）
│   ├── main.tsx             # 入口文件
│   └── index.css            # 全局样式（色彩系统）
├── index.html               # HTML 模板
├── package.json             # 项目配置
├── tsconfig.json            # TypeScript 配置
├── tailwind.config.ts       # Tailwind CSS 配置
├── vite.config.ts           # Vite 配置
├── eslint.config.js         # ESLint 配置
└── README.md                # 项目说明
```

### 附录 C：关键 API 说明

#### localStorage API

```typescript
// 存储 Key
const STORAGE_KEY = "custom-restaurants";

// 数据结构
type CustomList = string[];

// 保存
localStorage.setItem(STORAGE_KEY, JSON.stringify(customList));

// 读取
const saved = localStorage.getItem(STORAGE_KEY);
const customList: CustomList = saved ? JSON.parse(saved) : [];

// 清空
localStorage.removeItem(STORAGE_KEY);
```

#### 餐厅数据结构

```typescript
export interface Restaurant {
  id: string;           // 唯一标识
  name: string;         // 餐厅名称
  address: string;      // 地址信息
  category: string;     // 餐厅分类
}

export const presetRestaurants: Restaurant[] = [
  { 
    id: "1", 
    name: "食堂一楼", 
    address: "学校食堂一楼东区", 
    category: "中餐" 
  },
  // ... 更多数据
];
```

### 附录 D：更新日志

| 版本 | 日期 | 更新内容 |
| --- | --- | --- |
| v1.0.0 | 2025-01 | 初始版本，MVP 功能全部实现 |
| - | - | 基础框架搭建 + 核心功能 |
| - | - | 系统推荐 + 自定义模式 |
| - | - | 转盘动画 + 结果展示 |
| - | - | 响应式适配 |

---

## 总结

《等会吃啥》是一款为解决“吃饭选择困难症”而设计的轻量级 Web 应用。通过精美的转盘动画和人性化的交互设计，为用户提供轻松有趣的决策体验。

### 产品亮点

1. **简单易用**：无需注册，打开即用，3 秒内得到结果
2. **双模式设计**：系统推荐 + 自定义，灵活满足不同场景
3. **视觉治愈**：清新草绿色系，大圆角设计，轻微动画反馈
4. **数据本地化**：自动保存自定义列表，无需担心丢失
5. **性能优秀**：首屏加载 < 1s，动画流畅 60fps

### 技术特色

- 采用 React 18 + TypeScript 构建，类型安全
- Tailwind CSS + shadcn/ui 组件库，快速开发
- Vite 构建工具，极速开发体验
- 自定义动画系统，流畅且轻量
- localStorage 持久化，无需后端

### 未来展望

我们将持续优化产品体验，逐步推出：
- 历史记录与数据导入导出
- 分享功能与社交传播
- 多人协同决策模式
- 智能推荐算法

感谢选择《等会吃啥》，祝您吃饭愉快！🍱

---

<div align="center">

**文档版本：v1.1** | **最后更新：2025-11-04**

Made with ❤️ by Decision Dish Team

</div>




